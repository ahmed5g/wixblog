import { Component, inject, signal } from '@angular/core';
import {CommonModule, NgIf} from '@angular/common';
import { Router, RouterLink } from '@angular/router';

import {AuthState} from '../../features/auth/auth-state';
import {MenuAction, UserAvatarWithDropDown} from '../../features/user/user-avatar-with-DropDown';


@Component({
  selector: 'app-top-bar',
  standalone: true,
  imports: [CommonModule, UserAvatarWithDropDown, NgIf, RouterLink],
  template: `
  <header class="top-bar ">
  <div class="container">
    <!-- Left: logo + desktop search -->
    <div class="left">
      <!-- **** LOGO SVG (replace with yours) **** -->
      <a routerLink="/" class="logo" aria-label="Home">
        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="200px" height="200px" viewBox="0 0 200 200" version="1.1">
          <g id="surface1">
            <path style=" stroke:none;fill-rule:nonzero;fill:rgb(99.607843%,99.607843%,99.215686%);fill-opacity:1;" d="M 110.546875 200.097656 C 73.699219 200.097656 36.898438 200.097656 0.0976562 200.097656 C 0.0976562 133.429688 0.0976562 66.765625 0.0976562 0.0976562 C 66.765625 0.0976562 133.429688 0.0976562 200.097656 0.0976562 C 200.097656 66.765625 200.097656 133.429688 200.097656 200.097656 C 170.265625 200.097656 140.429688 200.097656 110.546875 200.097656 M 150.222656 168.25 C 150.347656 168.28125 150.476562 168.304688 150.597656 168.351562 C 151.953125 168.894531 153.367188 169.171875 154.816406 169.285156 C 156.675781 169.429688 158.492188 169.25 160.230469 168.550781 C 162.101562 167.796875 163.523438 166.539062 164.339844 164.667969 C 164.871094 163.460938 165.09375 162.179688 165.105469 160.867188 C 165.121094 159.46875 165.121094 158.066406 165.125 156.667969 C 165.128906 152.976562 165.132812 149.28125 165.136719 145.589844 C 165.136719 145.367188 165.128906 145.148438 165.125 144.929688 C 163.550781 144.929688 162.042969 144.929688 160.5 144.929688 C 160.492188 145.472656 160.527344 145.996094 160.367188 146.527344 C 160.210938 146.421875 160.121094 146.285156 160.007812 146.171875 C 159.445312 145.617188 158.796875 145.191406 158.058594 144.902344 C 156.628906 144.347656 155.167969 144.3125 153.691406 144.644531 C 150.53125 145.363281 148.542969 147.371094 147.566406 150.394531 C 146.992188 152.175781 146.996094 154.019531 147.390625 155.847656 C 147.753906 157.527344 148.539062 159 149.808594 160.160156 C 151.421875 161.632812 153.363281 162.203125 155.523438 162.0625 C 157.144531 161.957031 158.546875 161.34375 159.714844 160.210938 C 159.847656 160.082031 159.980469 159.953125 160.191406 159.746094 C 160.144531 160.757812 160.222656 161.660156 160.007812 162.550781 C 159.742188 163.640625 159.09375 164.398438 158.078125 164.851562 C 157.304688 165.195312 156.484375 165.320312 155.652344 165.320312 C 153.683594 165.328125 151.867188 164.777344 150.179688 163.78125 C 150.007812 163.675781 149.832031 163.574219 149.664062 163.472656 C 149.222656 164.382812 148.804688 165.246094 148.382812 166.105469 C 148.25 166.378906 148.109375 166.648438 147.957031 166.996094 C 148.632812 167.515625 149.410156 167.851562 150.222656 168.25 M 50.265625 90.058594 C 49.480469 91.886719 49.054688 93.789062 49 95.78125 C 48.910156 98.890625 49.71875 101.75 51.433594 104.320312 C 53.332031 107.167969 55.941406 109.140625 59.1875 110.265625 C 61.707031 111.140625 64.257812 111.34375 66.867188 110.734375 C 68.804688 110.277344 70.601562 109.511719 72.226562 108.355469 C 73.644531 107.347656 74.839844 106.121094 75.835938 104.691406 C 76.785156 103.332031 77.546875 101.878906 78 100.289062 C 78.601562 98.1875 78.75 96.046875 78.445312 93.863281 C 78.132812 91.582031 77.378906 89.472656 76.105469 87.566406 C 73.59375 83.796875 70.03125 81.667969 65.566406 81.082031 C 61.824219 80.589844 58.4375 81.601562 55.378906 83.746094 C 53.105469 85.34375 51.441406 87.460938 50.265625 90.058594 M 40.042969 151.039062 C 41.171875 154.800781 42.296875 158.566406 43.414062 162.304688 C 45.285156 162.304688 47.121094 162.304688 48.988281 162.304688 C 50.625 157.222656 52.253906 152.160156 53.878906 147.101562 C 53.90625 147.097656 53.933594 147.097656 53.960938 147.09375 C 55.558594 152.164062 57.15625 157.238281 58.75 162.300781 C 60.558594 162.300781 62.34375 162.300781 64.125 162.300781 C 66.707031 154.242188 69.277344 146.214844 71.859375 138.148438 C 70.066406 138.148438 68.304688 138.148438 66.523438 138.148438 C 64.828125 143.777344 63.144531 149.378906 61.4375 155.046875 C 59.757812 149.359375 58.101562 143.742188 56.457031 138.175781 C 54.894531 138.175781 53.40625 138.175781 51.921875 138.175781 C 50.242188 143.808594 48.574219 149.398438 46.882812 155.058594 C 45.265625 149.371094 43.671875 143.769531 42.082031 138.183594 C 41.035156 138.066406 36.546875 138.101562 36.179688 138.222656 C 36.652344 139.742188 37.140625 141.257812 37.597656 142.78125 C 38.417969 145.503906 39.214844 148.234375 40.042969 151.039062 M 88.605469 82.03125 C 87.402344 81.714844 86.316406 81.980469 85.34375 82.730469 C 84.578125 83.320312 83.9375 84.023438 83.402344 84.839844 C 82.113281 86.816406 81.339844 89 80.902344 91.300781 C 80.125 95.378906 80.238281 99.425781 81.542969 103.398438 C 82.210938 105.429688 83.160156 107.308594 84.785156 108.757812 C 86.304688 110.113281 87.945312 110.335938 89.660156 109.277344 C 90.785156 108.585938 91.597656 107.597656 92.265625 106.484375 C 93.375 104.652344 94.039062 102.65625 94.449219 100.566406 C 95.089844 97.300781 95.078125 94.03125 94.378906 90.777344 C 93.90625 88.582031 93.132812 86.5 91.820312 84.652344 C 91.007812 83.507812 90.058594 82.519531 88.605469 82.03125 M 116.183594 146.851562 C 114.917969 145.449219 113.328125 144.65625 111.460938 144.46875 C 109.039062 144.21875 106.949219 144.941406 105.25 146.890625 C 105.25 143.707031 105.25 140.648438 105.25 137.542969 C 103.585938 137.5625 101.953125 137.519531 100.339844 137.5625 C 100.339844 145.855469 100.339844 154.082031 100.339844 162.300781 C 101.960938 162.300781 103.542969 162.300781 105.148438 162.300781 C 105.148438 161.96875 105.136719 161.675781 105.152344 161.386719 C 105.164062 161.109375 105.09375 160.820312 105.238281 160.484375 C 105.3125 160.582031 105.34375 160.640625 105.390625 160.6875 C 107.503906 162.875 110.351562 163.351562 113.015625 162.277344 C 115.339844 161.339844 116.867188 159.617188 117.667969 157.253906 C 118.425781 155.023438 118.480469 152.753906 117.957031 150.46875 C 117.65625 149.152344 117.113281 147.945312 116.183594 146.851562 M 145.597656 156.195312 C 146.027344 154.578125 146.066406 152.953125 145.707031 151.316406 C 145.148438 148.769531 143.726562 146.839844 141.4375 145.605469 C 139.199219 144.398438 136.808594 144.144531 134.339844 144.757812 C 132.074219 145.316406 130.242188 146.546875 129.019531 148.527344 C 127.199219 151.484375 127.054688 154.613281 128.488281 157.761719 C 129.648438 160.320312 131.734375 161.804688 134.410156 162.5 C 135.820312 162.867188 137.246094 162.859375 138.667969 162.578125 C 140.402344 162.230469 141.933594 161.480469 143.207031 160.25 C 144.355469 159.140625 145.148438 157.8125 145.597656 156.195312 M 92.789062 153.410156 C 92.71875 153.304688 92.644531 153.195312 92.5625 153.070312 C 94.429688 150.371094 96.324219 147.699219 98.191406 144.929688 C 96.335938 144.929688 94.570312 144.929688 92.808594 144.929688 C 91.78125 146.5 90.761719 148.058594 89.726562 149.640625 C 89.660156 149.582031 89.601562 149.550781 89.570312 149.503906 C 88.667969 148.09375 87.757812 146.6875 86.871094 145.269531 C 86.703125 145 86.539062 144.894531 86.21875 144.898438 C 84.527344 144.917969 82.835938 144.90625 81.144531 144.90625 C 81.019531 144.90625 80.898438 144.917969 80.710938 144.925781 C 82.710938 147.714844 84.664062 150.441406 86.609375 153.148438 C 86.46875 153.347656 86.363281 153.492188 86.261719 153.636719 C 85.035156 155.375 83.804688 157.117188 82.578125 158.855469 C 81.847656 159.890625 81.117188 160.929688 80.390625 161.96875 C 80.3125 162.078125 80.257812 162.207031 80.1875 162.332031 C 82.09375 162.332031 83.945312 162.332031 85.800781 162.332031 C 87.039062 160.425781 88.261719 158.539062 89.496094 156.632812 C 90.742188 158.558594 91.964844 160.453125 93.167969 162.308594 C 95.15625 162.308594 97.097656 162.308594 99.050781 162.308594 C 99.03125 162.246094 99.027344 162.210938 99.007812 162.1875 C 98.046875 160.816406 97.089844 159.441406 96.121094 158.074219 C 95.03125 156.535156 93.929688 155.003906 92.789062 153.410156 M 120.480469 152.585938 C 120.480469 155.820312 120.480469 159.054688 120.480469 162.300781 C 122.164062 162.300781 123.800781 162.300781 125.441406 162.300781 C 125.441406 154.03125 125.441406 145.777344 125.441406 137.539062 C 123.773438 137.539062 122.148438 137.539062 120.480469 137.539062 C 120.480469 142.539062 120.480469 147.515625 120.480469 152.585938 M 96.628906 94.585938 C 96.523438 97.488281 96.695312 100.375 97.191406 103.238281 C 97.417969 104.519531 97.671875 105.796875 98.15625 107.007812 C 98.328125 107.441406 98.558594 107.859375 98.824219 108.242188 C 99.054688 108.582031 99.277344 108.570312 99.515625 108.222656 C 99.734375 107.90625 99.910156 107.550781 100.066406 107.195312 C 100.574219 106.042969 100.816406 104.8125 101.082031 103.589844 C 101.402344 102.128906 101.589844 100.644531 101.695312 99.148438 C 101.867188 96.742188 101.890625 94.339844 101.691406 91.933594 C 101.5 89.5625 101.039062 87.234375 100.371094 84.953125 C 100.25 84.535156 100.070312 84.128906 99.886719 83.734375 C 99.765625 83.46875 99.609375 83.214844 99.292969 83.113281 C 98.789062 83.285156 98.609375 83.730469 98.425781 84.164062 C 97.949219 85.289062 97.675781 86.476562 97.429688 87.671875 C 96.960938 89.921875 96.695312 92.195312 96.628906 94.585938 M 78.332031 162.328125 C 78.402344 162.28125 78.507812 162.246094 78.53125 162.183594 C 78.5625 162.082031 78.539062 161.960938 78.539062 161.847656 C 78.546875 156.433594 78.554688 151.019531 78.558594 145.601562 C 78.558594 145.378906 78.558594 145.15625 78.558594 144.9375 C 76.84375 144.9375 75.175781 144.9375 73.480469 144.9375 C 73.480469 150.746094 73.480469 156.523438 73.480469 162.328125 C 75.089844 162.328125 76.664062 162.328125 78.332031 162.328125 M 77.292969 142.492188 C 77.40625 142.433594 77.527344 142.382812 77.636719 142.3125 C 78.609375 141.71875 79.132812 140.640625 78.964844 139.585938 C 78.644531 137.601562 76.285156 136.570312 74.574219 137.675781 C 73.582031 138.3125 73.179688 139.242188 73.332031 140.390625 C 73.46875 141.449219 74.078125 142.160156 75.074219 142.542969 C 75.792969 142.820312 76.507812 142.738281 77.292969 142.492188 Z M 77.292969 142.492188 "/>
            <path style=" stroke:none;fill-rule:nonzero;fill:rgb(1.568628%,1.568628%,0.784314%);fill-opacity:1;" d="M 50.28125 90.023438 C 51.441406 87.460938 53.105469 85.34375 55.378906 83.746094 C 58.4375 81.601562 61.824219 80.589844 65.566406 81.082031 C 70.03125 81.667969 73.59375 83.796875 76.105469 87.566406 C 77.378906 89.472656 78.132812 91.582031 78.445312 93.863281 C 78.75 96.046875 78.601562 98.1875 78 100.289062 C 77.546875 101.878906 76.785156 103.332031 75.835938 104.691406 C 74.839844 106.121094 73.644531 107.347656 72.226562 108.355469 C 70.601562 109.511719 68.804688 110.277344 66.867188 110.734375 C 64.257812 111.34375 61.707031 111.140625 59.1875 110.265625 C 55.941406 109.140625 53.332031 107.167969 51.433594 104.320312 C 49.71875 101.75 48.910156 98.890625 49 95.78125 C 49.054688 93.789062 49.480469 91.886719 50.28125 90.023438 Z M 50.28125 90.023438 "/>
            <path style=" stroke:none;fill-rule:nonzero;fill:rgb(1.176471%,1.176471%,1.176471%);fill-opacity:1;" d="M 40.035156 151 C 39.214844 148.234375 38.417969 145.503906 37.597656 142.78125 C 37.140625 141.257812 36.652344 139.742188 36.179688 138.222656 C 36.546875 138.101562 41.035156 138.066406 42.082031 138.183594 C 43.671875 143.769531 45.265625 149.371094 46.882812 155.058594 C 48.574219 149.398438 50.242188 143.808594 51.921875 138.175781 C 53.40625 138.175781 54.894531 138.175781 56.457031 138.175781 C 58.101562 143.742188 59.757812 149.359375 61.4375 155.046875 C 63.144531 149.378906 64.828125 143.777344 66.523438 138.148438 C 68.304688 138.148438 70.066406 138.148438 71.859375 138.148438 C 69.277344 146.214844 66.707031 154.242188 64.125 162.300781 C 62.34375 162.300781 60.558594 162.300781 58.75 162.300781 C 57.15625 157.238281 55.558594 152.164062 53.960938 147.09375 C 53.933594 147.097656 53.90625 147.097656 53.878906 147.101562 C 52.253906 152.160156 50.625 157.222656 48.988281 162.304688 C 47.121094 162.304688 45.285156 162.304688 43.414062 162.304688 C 42.296875 158.566406 41.171875 154.800781 40.035156 151 Z M 40.035156 151 "/>
            <path style=" stroke:none;fill-rule:nonzero;fill:rgb(1.176471%,1.176471%,0.784314%);fill-opacity:1;" d="M 88.644531 82.042969 C 90.058594 82.519531 91.007812 83.507812 91.820312 84.652344 C 93.132812 86.5 93.90625 88.582031 94.378906 90.777344 C 95.078125 94.03125 95.089844 97.300781 94.449219 100.566406 C 94.039062 102.65625 93.375 104.652344 92.265625 106.484375 C 91.597656 107.597656 90.785156 108.585938 89.660156 109.277344 C 87.945312 110.335938 86.304688 110.113281 84.785156 108.757812 C 83.160156 107.308594 82.210938 105.429688 81.542969 103.398438 C 80.238281 99.425781 80.125 95.378906 80.902344 91.300781 C 81.339844 89 82.113281 86.816406 83.402344 84.839844 C 83.9375 84.023438 84.578125 83.320312 85.34375 82.730469 C 86.316406 81.980469 87.402344 81.714844 88.644531 82.042969 Z M 88.644531 82.042969 "/>
            <path style=" stroke:none;fill-rule:nonzero;fill:rgb(1.176471%,1.176471%,1.176471%);fill-opacity:1;" d="M 147.96875 166.921875 C 148.109375 166.648438 148.25 166.378906 148.382812 166.105469 C 148.804688 165.246094 149.222656 164.382812 149.664062 163.472656 C 149.832031 163.574219 150.007812 163.675781 150.179688 163.78125 C 151.867188 164.777344 153.683594 165.328125 155.652344 165.320312 C 156.484375 165.320312 157.304688 165.195312 158.078125 164.851562 C 159.09375 164.398438 159.742188 163.640625 160.007812 162.550781 C 160.222656 161.660156 160.144531 160.757812 160.191406 159.746094 C 159.980469 159.953125 159.847656 160.082031 159.714844 160.210938 C 158.546875 161.34375 157.144531 161.957031 155.523438 162.0625 C 153.363281 162.203125 151.421875 161.632812 149.808594 160.160156 C 148.539062 159 147.753906 157.527344 147.390625 155.847656 C 146.996094 154.019531 146.992188 152.175781 147.566406 150.394531 C 148.542969 147.371094 150.53125 145.363281 153.691406 144.644531 C 155.167969 144.3125 156.628906 144.347656 158.058594 144.902344 C 158.796875 145.191406 159.445312 145.617188 160.007812 146.171875 C 160.121094 146.285156 160.210938 146.421875 160.367188 146.527344 C 160.527344 145.996094 160.492188 145.472656 160.5 144.929688 C 162.042969 144.929688 163.550781 144.929688 165.125 144.929688 C 165.128906 145.148438 165.136719 145.367188 165.136719 145.589844 C 165.132812 149.28125 165.128906 152.976562 165.125 156.667969 C 165.121094 158.066406 165.121094 159.46875 165.105469 160.867188 C 165.09375 162.179688 164.871094 163.460938 164.339844 164.667969 C 163.523438 166.539062 162.101562 167.796875 160.230469 168.550781 C 158.492188 169.25 156.675781 169.429688 154.816406 169.285156 C 153.367188 169.171875 151.953125 168.894531 150.597656 168.351562 C 150.476562 168.304688 150.347656 168.28125 150.222656 168.191406 C 150.296875 168.074219 150.375 168.019531 150.46875 167.949219 C 150.402344 167.910156 150.375 167.890625 150.347656 167.878906 C 149.871094 167.640625 149.359375 167.472656 148.929688 167.136719 C 148.652344 166.921875 148.347656 166.746094 147.96875 166.921875 M 154.992188 148.675781 C 154.03125 149.003906 153.351562 149.644531 152.910156 150.546875 C 152.011719 152.386719 152 154.261719 152.859375 156.097656 C 153.851562 158.222656 155.976562 158.667969 157.597656 158.082031 C 158.886719 157.613281 159.722656 156.652344 160.109375 155.351562 C 160.523438 153.964844 160.492188 152.554688 160.046875 151.171875 C 159.621094 149.84375 158.753906 148.941406 157.371094 148.589844 C 156.597656 148.394531 155.828125 148.390625 154.992188 148.675781 Z M 154.992188 148.675781 "/>
            <path style=" stroke:none;fill-rule:nonzero;fill:rgb(1.176471%,1.568628%,1.176471%);fill-opacity:1;" d="M 116.207031 146.878906 C 117.113281 147.945312 117.65625 149.152344 117.957031 150.46875 C 118.480469 152.753906 118.425781 155.023438 117.667969 157.253906 C 116.867188 159.617188 115.339844 161.339844 113.015625 162.277344 C 110.351562 163.351562 107.503906 162.875 105.390625 160.6875 C 105.34375 160.640625 105.3125 160.582031 105.238281 160.484375 C 105.09375 160.820312 105.164062 161.109375 105.152344 161.386719 C 105.136719 161.675781 105.148438 161.96875 105.148438 162.300781 C 103.542969 162.300781 101.960938 162.300781 100.339844 162.300781 C 100.339844 154.082031 100.339844 145.855469 100.339844 137.5625 C 101.953125 137.519531 103.585938 137.5625 105.25 137.542969 C 105.25 140.648438 105.25 143.707031 105.25 146.890625 C 106.949219 144.941406 109.039062 144.21875 111.460938 144.46875 C 113.328125 144.65625 114.917969 145.449219 116.207031 146.878906 M 113.175781 153.847656 C 113.171875 153.574219 113.183594 153.296875 113.164062 153.019531 C 113.09375 152.019531 112.878906 151.070312 112.335938 150.199219 C 111.148438 148.304688 109.164062 148.140625 107.839844 148.648438 C 106.4375 149.179688 105.683594 150.261719 105.363281 151.679688 C 105.132812 152.707031 105.15625 153.742188 105.246094 154.785156 C 105.304688 155.441406 105.488281 156.054688 105.738281 156.660156 C 106.761719 159.101562 110.167969 159.582031 111.886719 157.539062 C 112.761719 156.503906 113.132812 155.28125 113.175781 153.847656 Z M 113.175781 153.847656 "/>
            <path style=" stroke:none;fill-rule:nonzero;fill:rgb(1.176471%,1.176471%,1.176471%);fill-opacity:1;" d="M 145.585938 156.234375 C 145.148438 157.8125 144.355469 159.140625 143.207031 160.25 C 141.933594 161.480469 140.402344 162.230469 138.667969 162.578125 C 137.246094 162.859375 135.820312 162.867188 134.410156 162.5 C 131.734375 161.804688 129.648438 160.320312 128.488281 157.761719 C 127.054688 154.613281 127.199219 151.484375 129.019531 148.527344 C 130.242188 146.546875 132.074219 145.316406 134.339844 144.757812 C 136.808594 144.144531 139.199219 144.398438 141.4375 145.605469 C 143.726562 146.839844 145.148438 148.769531 145.707031 151.316406 C 146.066406 152.953125 146.027344 154.578125 145.585938 156.234375 M 140.113281 156.753906 C 141.089844 154.964844 141.207031 153.101562 140.507812 151.203125 C 140.136719 150.195312 139.472656 149.390625 138.488281 148.925781 C 136.71875 148.085938 134.523438 148.546875 133.378906 150.582031 C 132.742188 151.714844 132.601562 152.941406 132.695312 154.210938 C 132.777344 155.296875 133.070312 156.316406 133.753906 157.195312 C 134.726562 158.445312 136.308594 158.984375 137.746094 158.5625 C 138.746094 158.269531 139.488281 157.652344 140.113281 156.753906 Z M 140.113281 156.753906 "/>
            <path style=" stroke:none;fill-rule:nonzero;fill:rgb(1.176471%,1.176471%,1.176471%);fill-opacity:1;" d="M 92.8125 153.441406 C 93.929688 155.003906 95.03125 156.535156 96.121094 158.074219 C 97.089844 159.441406 98.046875 160.816406 99.007812 162.1875 C 99.027344 162.210938 99.03125 162.246094 99.050781 162.308594 C 97.097656 162.308594 95.15625 162.308594 93.167969 162.308594 C 91.964844 160.453125 90.742188 158.558594 89.496094 156.632812 C 88.261719 158.539062 87.039062 160.425781 85.800781 162.332031 C 83.945312 162.332031 82.09375 162.332031 80.1875 162.332031 C 80.257812 162.207031 80.3125 162.078125 80.390625 161.96875 C 81.117188 160.929688 81.847656 159.890625 82.578125 158.855469 C 83.804688 157.117188 85.035156 155.375 86.261719 153.636719 C 86.363281 153.492188 86.46875 153.347656 86.609375 153.148438 C 84.664062 150.441406 82.710938 147.714844 80.710938 144.925781 C 80.898438 144.917969 81.019531 144.90625 81.144531 144.90625 C 82.835938 144.90625 84.527344 144.917969 86.21875 144.898438 C 86.539062 144.894531 86.703125 145 86.871094 145.269531 C 87.757812 146.6875 88.667969 148.09375 89.570312 149.503906 C 89.601562 149.550781 89.660156 149.582031 89.726562 149.640625 C 90.761719 148.058594 91.78125 146.5 92.808594 144.929688 C 94.570312 144.929688 96.335938 144.929688 98.191406 144.929688 C 96.324219 147.699219 94.429688 150.371094 92.5625 153.070312 C 92.644531 153.195312 92.71875 153.304688 92.8125 153.441406 Z M 92.8125 153.441406 "/>
            <path style=" stroke:none;fill-rule:nonzero;fill:rgb(1.176471%,1.568628%,1.176471%);fill-opacity:1;" d="M 120.480469 152.539062 C 120.480469 147.515625 120.480469 142.539062 120.480469 137.539062 C 122.148438 137.539062 123.773438 137.539062 125.441406 137.539062 C 125.441406 145.777344 125.441406 154.03125 125.441406 162.300781 C 123.800781 162.300781 122.164062 162.300781 120.480469 162.300781 C 120.480469 159.054688 120.480469 155.820312 120.480469 152.539062 Z M 120.480469 152.539062 "/>
            <path style=" stroke:none;fill-rule:nonzero;fill:rgb(1.568628%,1.568628%,1.568628%);fill-opacity:1;" d="M 96.628906 94.539062 C 96.695312 92.195312 96.960938 89.921875 97.429688 87.671875 C 97.675781 86.476562 97.949219 85.289062 98.425781 84.164062 C 98.609375 83.730469 98.789062 83.285156 99.292969 83.113281 C 99.609375 83.214844 99.765625 83.46875 99.886719 83.734375 C 100.070312 84.128906 100.25 84.535156 100.371094 84.953125 C 101.039062 87.234375 101.5 89.5625 101.691406 91.933594 C 101.890625 94.339844 101.867188 96.742188 101.695312 99.148438 C 101.589844 100.644531 101.402344 102.128906 101.082031 103.589844 C 100.816406 104.8125 100.574219 106.042969 100.066406 107.195312 C 99.910156 107.550781 99.734375 107.90625 99.515625 108.222656 C 99.277344 108.570312 99.054688 108.582031 98.824219 108.242188 C 98.558594 107.859375 98.328125 107.441406 98.15625 107.007812 C 97.671875 105.796875 97.417969 104.519531 97.191406 103.238281 C 96.695312 100.375 96.523438 97.488281 96.628906 94.539062 Z M 96.628906 94.539062 "/>
            <path style=" stroke:none;fill-rule:nonzero;fill:rgb(1.176471%,1.176471%,1.176471%);fill-opacity:1;" d="M 78.285156 162.328125 C 76.664062 162.328125 75.089844 162.328125 73.480469 162.328125 C 73.480469 156.523438 73.480469 150.746094 73.480469 144.9375 C 75.175781 144.9375 76.84375 144.9375 78.558594 144.9375 C 78.558594 145.15625 78.558594 145.378906 78.558594 145.601562 C 78.554688 151.019531 78.546875 156.433594 78.539062 161.847656 C 78.539062 161.960938 78.5625 162.082031 78.53125 162.183594 C 78.507812 162.246094 78.402344 162.28125 78.285156 162.328125 Z M 78.285156 162.328125 "/>
            <path style=" stroke:none;fill-rule:nonzero;fill:rgb(1.960784%,1.960784%,1.960784%);fill-opacity:1;" d="M 77.257812 142.507812 C 76.507812 142.738281 75.792969 142.820312 75.074219 142.542969 C 74.078125 142.160156 73.46875 141.449219 73.332031 140.390625 C 73.179688 139.242188 73.582031 138.3125 74.574219 137.675781 C 76.285156 136.570312 78.644531 137.601562 78.964844 139.585938 C 79.132812 140.640625 78.609375 141.71875 77.636719 142.3125 C 77.527344 142.382812 77.40625 142.433594 77.257812 142.507812 Z M 77.257812 142.507812 "/>
            <path style=" stroke:none;fill-rule:nonzero;fill:rgb(1.960784%,1.960784%,1.960784%);fill-opacity:1;" d="M 147.964844 166.957031 C 148.347656 166.746094 148.652344 166.921875 148.929688 167.136719 C 149.359375 167.472656 149.871094 167.640625 150.347656 167.878906 C 150.375 167.890625 150.402344 167.910156 150.46875 167.949219 C 150.375 168.019531 150.296875 168.074219 150.203125 168.160156 C 149.410156 167.851562 148.632812 167.515625 147.964844 166.957031 Z M 147.964844 166.957031 "/>
            <path style=" stroke:none;fill-rule:nonzero;fill:rgb(98.823529%,98.823529%,98.823529%);fill-opacity:1;" d="M 155.027344 148.664062 C 155.828125 148.390625 156.597656 148.394531 157.371094 148.589844 C 158.753906 148.941406 159.621094 149.84375 160.046875 151.171875 C 160.492188 152.554688 160.523438 153.964844 160.109375 155.351562 C 159.722656 156.652344 158.886719 157.613281 157.597656 158.082031 C 155.976562 158.667969 153.851562 158.222656 152.859375 156.097656 C 152 154.261719 152.011719 152.386719 152.910156 150.546875 C 153.351562 149.644531 154.03125 149.003906 155.027344 148.664062 Z M 155.027344 148.664062 "/>
            <path style=" stroke:none;fill-rule:nonzero;fill:rgb(98.823529%,98.823529%,98.823529%);fill-opacity:1;" d="M 113.175781 153.894531 C 113.132812 155.28125 112.761719 156.503906 111.886719 157.539062 C 110.167969 159.582031 106.761719 159.101562 105.738281 156.660156 C 105.488281 156.054688 105.304688 155.441406 105.246094 154.785156 C 105.15625 153.742188 105.132812 152.707031 105.363281 151.679688 C 105.683594 150.261719 106.4375 149.179688 107.839844 148.648438 C 109.164062 148.140625 111.148438 148.304688 112.335938 150.199219 C 112.878906 151.070312 113.09375 152.019531 113.164062 153.019531 C 113.183594 153.296875 113.171875 153.574219 113.175781 153.894531 Z M 113.175781 153.894531 "/>
            <path style=" stroke:none;fill-rule:nonzero;fill:rgb(98.823529%,98.823529%,98.823529%);fill-opacity:1;" d="M 140.089844 156.78125 C 139.488281 157.652344 138.746094 158.269531 137.746094 158.5625 C 136.308594 158.984375 134.726562 158.445312 133.753906 157.195312 C 133.070312 156.316406 132.777344 155.296875 132.695312 154.210938 C 132.601562 152.941406 132.742188 151.714844 133.378906 150.582031 C 134.523438 148.546875 136.71875 148.085938 138.488281 148.925781 C 139.472656 149.390625 140.136719 150.195312 140.507812 151.203125 C 141.207031 153.101562 141.089844 154.964844 140.089844 156.78125 Z M 140.089844 156.78125 "/>
          </g>
        </svg>

      </a>

      <!-- **** DESKTOP SEARCH (optional) **** -->
      <div class="search-desktop">
        <svg class="search-icon" viewBox="0 0 24 24">
          <!-- magnifier icon -->
        </svg>
        <input type="text" placeholder="Search…" aria-label="Search">
      </div>
    </div>

    <!-- Right: actions -->
    <nav class="right">
      <!-- Write (desktop only) -->
      <a *ngIf="user()" routerLink="/write" class="write-link hide-mobile">
        <!-- **** PEN / WRITE ICON **** -->
        <svg class="icon" viewBox="0 0 24 24"><!-- … --></svg>
        <span>Write</span>
      </a>

      <!-- Search (mobile) -->
      <button (click)="toggleMobileSearch()" class="search-mobile-btn hide-desktop" aria-label="Search">
        <!-- **** MAGNIFIER ICON **** -->
        <svg class="icon" viewBox="0 0 24 24"><!-- … --></svg>
      </button>

<!--      &lt;!&ndash; Notifications &ndash;&gt;-->
<!--      <button class="notifications-btn hide-mobile" aria-label="Notifications">-->
<!--        &lt;!&ndash; **** BELL ICON **** &ndash;&gt;-->
<!--        <svg class="icon" viewBox="0 0 24 24">&lt;!&ndash; … &ndash;&gt;</svg>-->
<!--        <span class="badge"></span>-->
<!--      </button>-->

      <!-- User menu -->
      <app-user-avatar-with-dropdown  size="xl"  [ring]="true" (action)="onMenuAction($event)"/>
    </nav>
  </div>

  <!-- Mobile search panel -->
  <div *ngIf="mobileSearchOpen()" class="mobile-search">
    <div class="container">
      <svg class="search-icon" viewBox="0 0 24 24"><!-- … --></svg>
      <input type="text" placeholder="Search…" aria-label="Search">
    </div>
  </div>
</header>
  `,
  styles: `
    :host { display: block;
    }

    .top-bar {
      position: sticky;
      top: 0;
      z-index: 50;
      background: #fff;
      border-bottom: 1px solid #e5e7eb;

    }

    .container {
      max-width: 1280px;
      margin: 0 auto;
      padding: 0 1rem;
      height: 80px;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }

    .left, .right {
      display: flex;
      align-items: center;
      gap: 1rem;
    }

    .logo__img {
      width: 32px;
      height: 32px;
    }

    .search-desktop {
      display: none;
      position: relative;
      max-width: 240px;
      flex: 1;

      @media (min-width: 1024px) {
        display: block;
      }

      input {
        width: 100%;
        height: 36px;
        padding-left: 2.25rem;
        font-size: 0.875rem;
        border-radius: 9999px;
        border: 1px solid transparent;
        background: #f3f4f6;
        &:focus {
          outline: none;
          background: #fff;
          border-color: #d1d5db;
        }
      }
    }

    .search-icon {
      position: absolute;
      left: 0.75rem;
      top: 50%;
      transform: translateY(-50%);
      width: 16px;
      height: 16px;
      color: #6b7280;
    }

    .icon {
      width: 20px;
      height: 20px;
    }

    .write-link {
      display: inline-flex;
      align-items: center;
      gap: 0.4rem;
      font-size: 0.875rem;
      color: #4b5563;
      text-decoration: none;
      &:hover { color: #111827; }
    }

    .notifications-btn { position: relative; }

    .badge {
      position: absolute;
      top: 2px;
      right: 2px;
      width: 6px;
      height: 6px;
      background: #ef4444;
      border-radius: 50%;
    }

    .mobile-search {
      padding: 0.75rem 0;
      border-top: 1px solid #e5e7eb;
      input { width: 100%; }
    }

    .hide-mobile { display: none; }
    .hide-desktop { display: block; }

    @media (min-width: 768px) {
      .hide-mobile { display: inline-flex; }
      .hide-desktop { display: none; }
    }
  `
})
export class TopBar {
  private readonly auth = inject(AuthState);
  private readonly router = inject(Router);

  /* exposed for template */
  readonly user = this.auth.user;
  mobileSearchOpen = signal(false);

  /* --------- handlers ---------------------------------------------------- */
  toggleMobileSearch(): void {
    this.mobileSearchOpen.set(!this.mobileSearchOpen());
  }

  onMenuAction(action: MenuAction): void {
    switch (action) {
      case 'profile':
        this.router.navigate(['/user']);
        break;
      case 'signout':
        this.auth.logout();
        this.router.navigate(['/login']);
        break;
      default:
        console.log('top-bar →', action);
        break;
    }
  }
}
